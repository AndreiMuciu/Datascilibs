_id,repo_full_name,issue_id,number,title,body,user_login,user_id,state,locked,comments_count,created_at,updated_at,closed_at,labels,reactions_total,reactions_plus1,reactions_minus1,reactions_laugh,reactions_hooray,reactions_confused,reactions_heart,repo_name
6824cd8e0ce5dcec7842e7db,apache/superset,3054573750,33403,feat: mssql driver added,"<!---\r\nPlease write the PR title following the conventions at https://www.conventionalcommits.org/en/v1.0.0/\r\nExample:\r\nfix(dashboard): load charts correctly\r\n-->\r\n\r\n### SUMMARY\r\n<!--- Describe the change below, including rationale and design decisions -->\r\n\r\n### BEFORE/AFTER SCREENSHOTS OR ANIMATED GIF\r\n<!--- Skip this if not applicable -->\r\n\r\n### TESTING INSTRUCTIONS\r\n<!--- Required! What steps can be taken to manually verify the changes? -->\r\n\r\n### ADDITIONAL INFORMATION\r\n<!--- Check any relevant boxes with ""x"" -->\r\n<!--- HINT: Include ""Fixes #nnn"" if you are fixing an existing issue -->\r\n- [ ] Has associated issue:\r\n- [ ] Required feature flags:\r\n- [ ] Changes UI\r\n- [ ] Includes DB Migration (follow approval process in [SIP-59](https://github.com/apache/superset/issues/13351))\r\n  - [ ] Migration is atomic, supports rollback & is backwards-compatible\r\n  - [ ] Confirm DB migration upgrade and downgrade tested\r\n  - [ ] Runtime estimates and downtime expectations provided\r\n- [ ] Introduces new feature or API\r\n- [ ] Removes existing feature or API\r\n",sandrociceros-loonar,193523405,closed,false,0,2025-05-10T23:42:10+00:00,2025-05-11T02:58:27+00:00,2025-05-10T23:44:05+00:00,size/L;data:connect:mssql,0,0,0,0,0,0,0,apache_superset
6824cd8e0ce5dcec7842e7dc,apache/superset,3054450412,33401,DuckDB error Invalid SSL Certificate Requirements Flag: CERT_NONE,"### Bug description\n\n**How to reproduce the bug**\n\n1. Install Superset 4.1.2 on Kubernetes 1.32.3 using the current Helm Chart 0.14.2 with Helm 3.17.3 and the custom value :\n```shell\nbootstrapScript: |\n  #!/bin/bash\n  pip install psycopg2-binary==2.9.6 \\n    ""duckdb-engine>=0.12.1, <0.13"" &&\\n  if [ ! -f ~/bootstrap ]; then echo ""Running Superset with uid {{ .Values.runAsUser }}"" > ~/bootstrap; fi\n```\n2. Connect to Superset\n3. Add new database\n4. In the dropdown select DuckDB database and fill in SQL Alchemy URI: duckdb:///:memory:\n5. Click `Test connection "" => OK\n6. Click `Finish`to register the database\n7. Go to SQL Lab\n8. Try to install httpfs extension :\n```sql\nINSTALL httpfs;\n```\n\n**Expected results**\n\nThe https extension should be installed and one can proceed with the connection to a S3 repository :\n\n```sql\nLOAD https;\n\nSET s3_region='fr-par';\nSET s3_endpoint='http://s3.fr-par.scw.cloud';\nSET s3_access_key_id='xxxxxxx';\nSET s3_secret_access_key='xxxx-xxxx-xxxx-xxxx-xxxxxx';\nSET s3_url_style = 'vhost';\nSET s3_use_ssl=true;\n\nSELECT *\nFROM 'https://<bucket>.s3.fr-par.scw.cloud/naiades_analyse_physicochimie.parquet'\nLIMIT 10;\n```\n\n**Actual results**\n\nThe error `DuckDB error  Invalid SSL Certificate Requirements Flag: CERT_NONE` appears\n\n\n\n### Screenshots/recordings\n\n![Image](https://github.com/user-attachments/assets/8d02c5e8-95aa-48c6-b7f9-0fb7f879b155)\n\n![Image](https://github.com/user-attachments/assets/6735e955-fe27-4343-8d8d-8db1c57c3531)\n\n\n### Superset version\n\n4.1.2\n\n### Python version\n\n3.10\n\n### Node version\n\nI don't know\n\n### Browser\n\nChrome\n\n### Additional context\n\n- Superset python log :\n\n```shell\n100.64.0.241 - - [10/May/2025:18:09:30 +0000] ""GET /health HTTP/1.1"" 200 2 ""-"" ""kube-probe/1.32""\n172.16.16.5 - - [10/May/2025:18:09:32 +0000] ""POST /tabstateview/ HTTP/1.1"" 400 1319 ""http://51.159.25.29:8088/sqllab/"" ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36""\n2025-05-10 18:09:33,547:INFO:superset.commands.sql_lab.execute:Triggering query_id: 15\n2025-05-10 18:09:33,565:INFO:superset.sql_lab:Query 15: Executing 1 statement(s)\n2025-05-10 18:09:33,565:INFO:superset.sql_lab:Query 15: Set query to 'running'\n2025-05-10 18:09:33,600:INFO:superset.sql_lab:Query 15: Running statement 1 out of 1\n2025-05-10 18:09:33,659:INFO:superset.sql_lab:Query 15: Storing results in results backend, key: 5a7dc232-274e-427b-9cec-b1e2d7146a58\n2025-05-10 18:09:33,684:WARNING:superset.views.error_handling:SupersetErrorsException\nTraceback (most recent call last):\n  File ""/usr/local/lib/python3.10/site-packages/flask/app.py"", line 1484, in full_dispatch_request\n    rv = self.dispatch_request()\n  File ""/usr/local/lib/python3.10/site-packages/flask/app.py"", line 1469, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)\n  File ""/usr/local/lib/python3.10/site-packages/flask_appbuilder/security/decorators.py"", line 95, in wraps\n    return f(self, *args, **kwargs)\n  File ""/app/superset/views/base_api.py"", line 119, in wraps\n    duration, response = time_function(f, self, *args, **kwargs)\n  File ""/app/superset/utils/core.py"", line 1364, in time_function\n    response = func(*args, **kwargs)\n  File ""/app/superset/views/base_api.py"", line 91, in wraps\n    return f(self, *args, **kwargs)\n  File ""/app/superset/utils/log.py"", line 303, in wrapper\n    value = f(*args, **kwargs)\n  File ""/app/superset/sqllab/api.py"", line 409, in execute_sql_query\n    command_result: CommandResult = command.run()\n  File ""/app/superset/utils/decorators.py"", line 266, in wrapped\n    return on_error(ex)\n  File ""/app/superset/utils/decorators.py"", line 236, in on_error\n    raise ex\n  File ""/app/superset/utils/decorators.py"", line 259, in wrapped\n    result = func(*args, **kwargs)\n  File ""/app/superset/commands/sql_lab/execute.py"", line 105, in run\n    status = self._run_sql_json_exec_from_scratch()\n  File ""/app/superset/commands/sql_lab/execute.py"", line 158, in _run_sql_json_exec_from_scratch\n    return self._sql_json_executor.execute(\n  File ""/app/superset/sqllab/sql_json_executer.py"", line 110, in execute\n    raise SupersetErrorsException(\nsuperset.exceptions.SupersetErrorsException: [SupersetError(message='Invalid SSL Certificate Requirements Flag: CERT_NONE', error_type=<SupersetErrorType.GENERIC_DB_ENGINE_ERROR: 'GENERIC_DB_ENGINE_ERROR'>, level=<ErrorLevel.ERROR: 'error'>, extra={'engine_name': 'DuckDB', 'issue_codes': [{'code': 1002, 'message': 'Issue 1002 - The database returned an unexpected error.'}]})]\n172.16.16.5 - - [10/May/2025:18:09:33 +0000] ""POST /api/v1/sqllab/execute/ HTTP/1.1"" 500 279 ""http://51.159.25.29:8088/sqllab/"" ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36""\n172.16.16.5 - - [10/May/2025:18:09:33 +0000] ""GET /api/v1/query/updated_since?q=(last_updated_ms:1746900563101) HTTP/1.1"" 200 540 ""http://51.159.25.29:8088/sqllab/"" ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36""\n172.16.16.5 - - [10/May/2025:18:09:34 +0000] ""POST /superset/log/?explode=events HTTP/1.1"" 200 20 ""http://51.159.25.29:8088/sqllab/"" ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36""\n100.64.0.241 - - [10/May/2025:18:09:35 +0000] ""GET /health HTTP/1.1"" 200 2 ""-"" ""kube-probe/1.32""\n172.16.16.5 - - [10/May/2025:18:09:37 +0000] ""POST /tabstateview/ HTTP/1.1"" 400 1319 ""http://51.159.25.29:8088/sqllab/"" ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36""\n172.16.16.5 - - [10/May/2025:18:09:38 +0000] ""PUT /tabstateview/6 HTTP/1.1"" 200 1 ""http://51.159.25.29:8088/sqllab/"" ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36""\n```\n\n- The connection tested with `superset test-db` works fine\n\n```shell\n# Identify superset master pod\nkubectl get pods\n# Launch shell into the identifed pod\nkubectl exec -it superset-7d64cf964f-xqrzt -- bash\n# Test DuckDB connection\nsuperset test-db duckdb:///:memory:\n# Fill the JSON engine params and validate with CTRL+D\n{""connect_args"":{""preload_extensions"":[""httpfs""],""config"":{""s3_region"":""fr-par"",""s3_access_key_id"":""xxxxxxx"",""s3_secret_access_key"":""xxxxxx-xxxx-xxxx-xxxx-xxxxxxxx"",""s3_endpoint"":""https://s3.fr-par.scw.cloud"",""s3_url_style"":""vhost"",""s3_use_ssl"":""True""}}}\n```\n- The connection with python script works fine\n\n```python\nimport sqlalchemy\n\nREGION = ""fr-par""\nACCESS_KEY_ID = ""xxxxxxxx""\nSECRET_ACCESS_KEY = ""xxxxx-xxxx-xxxx-xxxx-xxxxxxx""\nBUCKET = ""xxxxx""\nFILE = ""naiades_analyse_physicochimie.parquet""\n\nurl = f""https://{BUCKET}.s3.{REGION}.scw.cloud/{FILE}""\nendpoint = f""https://s3.{REGION}.scw.cloud""\n\nif __name__ == ""__main__"":\n    engine = sqlalchemy.create_engine(\n        ""duckdb:///:memory:"",\n        connect_args={\n            ""config"": {\n                ""s3_region"": REGION,\n                ""s3_access_key_id"": ACCESS_KEY_ID,\n                ""s3_secret_access_key"": SECRET_ACCESS_KEY,\n                ""s3_endpoint"": endpoint,\n                ""s3_url_style"": ""vhost"",\n                ""s3_use_ssl"": True,\n            },\n        },\n    )\n    with engine.begin() as conn:\n        conn.execute(""INSTALL spatial; LOAD spatial;"")\n        conn.execute(""INSTALL https; LOAD https;"")\n        result = conn.execute(f""SELECT * FROM '{url}' LIMIT 10;"")\n        print(result.fetchall())\n```\n\n### Checklist\n\n- [x] I have searched Superset docs and Slack and didn't find a solution to my problem.\n- [x] I have searched the GitHub issue tracker and didn't find a similar bug report.\n- [x] I have checked Superset's logs for errors and if I found a relevant Python stacktrace, I included it here as text in the ""additional context"" section.",antonio-andrade,63242934,open,false,1,2025-05-10T18:36:51+00:00,2025-05-10T18:39:11+00:00,NaN,sqllab;data:connect:duckdb,0,0,0,0,0,0,0,apache_superset
